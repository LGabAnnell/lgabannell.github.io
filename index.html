<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Personal Notes</title>
    <script src="https://cdn.jsdelivr.net/npm/marked/lib/marked.umd.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="styles.css">
</head>

<body class="bg-gray-50">
    <div class="container mx-auto p-4">
        <header class="text-center my-8">
            <h1 class="text-4xl font-bold text-gray-800">Personal Notes</h1>
            <p class="text-gray-600 mt-2">A collection of my thoughts and ideas</p>
        </header>

        <div class="flex flex-col md:flex-row gap-8">
            <aside class="w-full md:w-1/4 bg-white p-4 rounded-lg shadow-md">
                <h2 class="text-xl font-semibold text-gray-700 mb-4">Notes</h2>
                <div id="links" class="space-y-2"></div>
            </aside>

            <main class="w-full md:w-3/4 bg-white p-6 rounded-lg shadow-md">
                <div id="markdown-content" class="prose max-w-none"></div>
            </main>
        </div>
    </div>

    <script>
        function createMarkdownLink(file, linksContainer, content) {
            const link = document.createElement('a');
            link.href = `#`;
            link.className = 'block p-2 rounded-md hover:bg-gray-100 text-gray-700';
            link.onclick = e => {
                e.preventDefault();
                fetch(file)
                    .then(res => res.text())
                    .then(md => {
                        const html = marked.parse(md);
                        content.innerHTML = html;
                    });
            };
            link.textContent = file.replace('.md', '');
            linksContainer.appendChild(link);
        }

        document.addEventListener('DOMContentLoaded', function () {
            const repo = 'lgabannell.github.io';
            const user = 'lgabannell';
            const content = document.getElementById('markdown-content');
            fetch(`https://api.github.com/repos/${user}/${repo}/git/trees/main`)
                .then(result => result.json())
                .then(result => result.tree
                    .filter(obj => obj.path.endsWith(".md"))
                    .filter(obj => !obj.path.startsWith("README"))
                    .map(object => object.path)
                    .sort()
                )
                .then(mdfiles => {
                    const linksContainer = document.getElementById('links');
                    mdfiles.forEach(file => {
                        createMarkdownLink(file, linksContainer, content);
                    });
                });
        });
    </script>
</body>

</html>